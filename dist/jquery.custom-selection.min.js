/*! jquery-custom-selection - v0.2.2 - 2014-10-22 */
!function(a){function b(a){Vb=a[0].ownerDocument,Ub=p(a[0])}function c(a){Eb=new Hammer.Manager(a[0],{recognizers:[[Hammer.Press],[Hammer.Tap]]}),Eb.set({holdThreshold:Db.holdThreshold,holdTimeout:Db.holdTimeout})}function d(b){c(b),a(Mb).add(Nb).on("touchstart",i),a(o(Mb)).on("touchmove",j).on("touchend",k),b.on("touchend",g),Eb.on("press",f),Eb.on("tap",v),a(Ub).on("orientationchange resize",l)}function e(b){a(o(Mb)).off("touchmove",j).off("touchend",k),b.off("touchend",g),Eb.destroy()}function f(a){a.srcEvent.preventDefault(),a.srcEvent.stopPropagation(),t(a)}function g(a){Tb&&(a.preventDefault(),Tb=!1)}function h(a){a.preventDefault(),Rb=F(a.originalEvent),Lb.requestFrame(function(){var a=K(Rb),b=_(Rb,a);u(b)})}function i(a){a.preventDefault(),D(a.target),Yb=q()}function j(a){Xb&&(h(a),Tb=!0)}function k(){Xb&&(E(),Yb=null)}function l(){Wb&&w()}function m(){a(Xb).removeClass(Ib),Xb=Xb===Mb?Nb:Mb,a(Xb).addClass(Ib)}function n(){return Db.scaleGetter()}function o(a){return(a.ownerDocument||a[0].ownerDocument).body}function p(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function q(){return Xb===Mb?hb(Wb):gb(Wb)}function r(b){b=a(b),Zb=b.css("user-select"),b.css("user-select","none")}function s(b){b=a(b),b.css("user-select",Zb)}function t(a){var b=J(a);if(!C(b)){v();var c=G(a,{shift:!1}),d=W(b,c);u(d),Tb=!0}}function u(a){z(a)&&(Wb=a,w(),Db.onSelectionChange(Wb)),N()}function v(){Wb=null,M(),Ob.clearSelection(),Db.onSelectionChange(Vb.createRange())}function w(){Ob.redraw(Wb),A(Wb)}function x(a){return 0!==Wb.compareBoundaryPoints(Range.END_TO_END,a)}function y(a){return 0!==Wb.compareBoundaryPoints(Range.START_TO_START,a)}function z(a){return!Wb||x(a)||y(a)}function A(a){var b=a.getClientRects(),c=b[0],d=b[b.length-1];Mb.style.top=V(c.bottom)+"px",Mb.style.left=U(c.left)+"px",Nb.style.top=V(d.bottom)+"px",Nb.style.left=U(d.right)+"px"}function B(b){Mb=a(Db.startMarker)[0]||L(b,Gb),Nb=a(Db.endMarker)[0]||L(b,Hb),$b=P(b),M()}function C(a){return a===Mb||a===Nb}function D(b){Xb=b,a(Xb).addClass(Ib)}function E(){a(Xb).removeClass(Ib),Xb=null}function F(a){var b=G(a);return b.translate.apply(b,H()),b.scale(I()),b}function G(a,b){return new CustomSelection.Lib.Point(a,b)}function H(){var a=$b;return[-a.framesOffsetX,-a.framesOffsetY]}function I(){return 1/n()}function J(a){var b=a.touches||a.pointers||[a];return b[0].target}function K(a){M();var b=Vb.elementFromPoint(a.clientX,a.clientY);return N(),b}function L(a,b){var c=Vb.createElement("div");return c.setAttribute("class",Fb+" "+b),c.setAttribute("style","position: absolute;"),a.append(c),c}function M(){a(Mb).add(Nb).css({visibility:"hidden"})}function N(){a(Mb).add(Nb).css({visibility:"visible"})}function O(a,b){return a.offsetParent===b.offsetParent}function P(a){if(O(Mb,Nb))return Q(a);throw new Error("Both marker elements must have the same offset parent!")}function Q(a){var b=R(a[0]),c=S(Mb);return{x:b.elementX-c.elementX,y:b.elementY-c.elementY,framesOffsetX:b.frameX-c.frameX,framesOffsetY:b.frameY-c.frameY}}function R(a){var b=a.offsetParent,c=p(b),d=T(c),e=b.getBoundingClientRect();return{elementX:d.left+e.left*n(),elementY:d.top+e.top*n(),frameX:d.left,frameY:d.top}}function S(a){var b=a.offsetParent,c=p(b),d=T(c),e=b.getBoundingClientRect();return{elementX:d.left+e.left,elementY:d.top+e.top,frameX:d.left,frameY:d.top}}function T(a){var b={top:0,left:0},c=a.frameElement;if(c){var d=c.getBoundingClientRect(),e=a.document.body.getBoundingClientRect();b.left+=d.left+c.clientLeft-e.left,b.top+=d.top+c.clientTop-e.top,a!==top&&T(a.parent,b)}return b}function U(a){return a*n()+$b.x}function V(a){return a*n()+$b.y}function W(a,b){var c,d=null;return(c=ib(a,b))&&(d=db(c,b),X(d),Y(d)),d}function X(a){for(;!Z(a);){if(a.startOffset<1)return;a.setStart(a.startContainer,a.startOffset-1)}a.setStart(a.startContainer,a.startOffset+1)}function Y(a){for(var b=Math.max(a.endContainer.data.length,0);!$(a);){if(a.endOffset>=b)return;a.setEnd(a.endContainer,a.endOffset+1)}a.setEnd(a.endContainer,a.endOffset-1)}function Z(a){return a.toString().charCodeAt(0)in Sb}function $(a){var b=a.toString();return b.charCodeAt(b.length-1)in Sb}function _(a,b){var c=Wb.cloneRange(),d=cb(b,a);if(d){var e=ab(d),f=bb();e.applyTo(c),c.collapsed&&(f.applyTo(c),e.applyOppositeTo(c),m())}return c}function ab(a){return Xb===Mb?eb(a):fb(a)}function bb(){var a=q();return Xb===Mb?eb(a):fb(a)}function cb(a,b){var c,d,e=null;return(c=ib(a,b))&&(d=db(c,b))?e=gb(d):(d=rb(a,b))&&(e=hb(d)),e}function db(a,b){for(var c=Vb.createRange(),d=0,e=a.data.length;e>d;){var f=d+e>>1;c.setStart(a,d),c.setEnd(a,f+1),jb(c,b)?e=f:(d=f+1,c.setStart(a,d),c.setEnd(a,e))}return c}function eb(a){return new CustomSelection.Lib.StartBoundary(a)}function fb(a){return new CustomSelection.Lib.EndBoundary(a)}function gb(a){return{container:a.startContainer,offset:a.startOffset}}function hb(a){return{container:a.endContainer,offset:a.endOffset}}function ib(a,b){if(a)for(var c,d=a.childNodes,e=0;c=d[e++];)if(pb(c)&&kb(c,b))return c;return null}function jb(a,b){for(var c,d=a.getClientRects(),e=0;c=d[e++];)if(mb(c,b))return!0;return!1}function kb(a,b){for(var c,d=lb(a),e=0;c=d[e++];)if(mb(c,b))return!0;return!1}function lb(a){var b=Vb.createRange();return b.selectNode(a),b.getClientRects()}function mb(a,b){return nb(a,b)&&ob(a,b)}function nb(a,b){var c=Kb?b.pageY:b.clientY;return c>a.top&&c<a.bottom}function ob(a,b){var c=Kb?b.pageX:b.clientX;return c>=a.left&&c<=a.right}function pb(a){return a.nodeType===Node.TEXT_NODE&&a.length}function qb(a){return a.childNodes.length>0}function rb(a,b){var c=null,d=vb({point:b,getBetterRect:wb,getBestRectFromNode:xb}),e=vb({point:b,getBetterRect:Bb,getBestRectFromNode:Cb}),f=tb(a,d)||tb(a,e);return f&&(c=Ab(),sb(null,null)),c}function sb(a,b){Pb=a,Qb=b}function tb(a,b){for(var c,d=a;c=ub(d,b);){if(pb(c))return c;d=c}}function ub(a,b){var c=null;if(a)for(var d,e=a.childNodes,f=0;d=e[f++];){var g;(g=lb(d))&&g.length&&(qb(d)||pb(d))&&(c=b(c,d))}return c}function vb(a){var b=a.point,c=a.getBetterRect,d=a.getBestRectFromNode;return function(a,e){var f=a,g=d(e,b);if(a){var h=d(a,b);yb(g,h)&&c(g,h)===g&&(f=e,sb(e,g))}else g&&(f=e,sb(e,g));return f}}function wb(a,b){return a.right>b.right?a:b.right>a.right?b:null}function xb(a,b){for(var c,d=lb(a),e=null,f=0;c=d[f++];)zb(c,b)&&(!e||c.right>e.right)&&(e=c);return e}function yb(a,b){return a&&b&&a!==b}function zb(a,b){var c=b.clientX,d=b.clientY;return a.right<c&&a.top<=d&&a.bottom>=d}function Ab(){var a=lb(Pb),b=a[a.length-1];if(Qb!==b&&pb(Pb)){var c={clientX:Qb.right-1,clientY:Qb.bottom-1};return db(Pb,c)}var d=document.createRange();return d.selectNode(Pb),d}function Bb(a,b){return a.top>=b.top?a:b.top>=a.top?b:null}function Cb(a,b){for(var c,d=b.clientY,e=lb(a),f=null,g=0;c=e[g++];)c.top<d&&(!f||c.top>=f.top)&&(f=c);return f}var Db,Eb,Fb="jcs-marker",Gb="jcs-beginning-marker",Hb="jcs-end-marker",Ib="jcs-marker-moving",Jb={holdThreshold:4,holdTimeout:500,onSelectionChange:function(){},scaleGetter:function(){return 1}},Kb=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,Lb=null,Mb=null,Nb=null,Ob=null;window.CustomSelection={Lib:{}},a.fn.customSelection=function(c){return Db=a.extend(Jb,c),b(this),Lb=new CustomSelection.Lib.FrameRequester,Ob=new CustomSelection.Lib.SelectionDrawer({$element:this,contextWindow:Ub,contextDocument:Vb,fillStyle:Db.selectionColor}),B(this),r(Vb.body),d(this),this},a.fn.clearCustomSelection=function(){return v(),this},a.fn.disableCustomSelection=function(){return v(),s(Vb.body),e(this),this};var Pb,Qb,Rb=null,Sb={32:" ",9:"	",13:"\r",10:"\n"},Tb=!1,Ub=null,Vb=null,Wb=null,Xb=null,Yb=null,Zb=null,$b={x:0,y:0}}(jQuery),function(a){"use strict";function b(a){this._container=a.container,this._offset=a.offset}function c(){b.apply(this,arguments)}function d(){b.apply(this,arguments)}c.prototype=Object.create(b.prototype),c.prototype.applyTo=function(a){a.setStart(this._container,this._offset)},c.prototype.applyOppositeTo=function(a){a.setEnd(this._container,this._offset)},a.CustomSelection.Lib.StartBoundary=c,d.prototype=Object.create(b.prototype),d.prototype.applyTo=function(a){a.setEnd(this._container,this._offset)},d.prototype.applyOppositeTo=function(a){a.setStart(this._container,this._offset)},a.CustomSelection.Lib.EndBoundary=d}(this),function(a){"use strict";function b(){this._ticking=!1}b.prototype.requestFrame=function(a){this._ticking||window.requestAnimationFrame(function(){a(),this._ticking=!1}.bind(this)),this._ticking=!0},a.CustomSelection.Lib.FrameRequester=b}(this),function(a){"use strict";function b(a,b){var e=$.extend({},c,b),f=a.touches||a.pointers,g=f[0];this.clientX=g.clientX,this.clientY=g.clientY,this.pageX=g.pageX,this.pageY=g.pageY,e.shift&&(this.clientY+=d,this.pageY+=d)}var c={shift:!0},d=-32;b.prototype.translate=function(a,b){this.clientX=this.clientX+a,this.clientY=this.clientY+b,this.pageX=this.pageX+a,this.pageY=this.pageY+b},b.prototype.scale=function(a){this.clientX=this.clientX*a,this.clientY=this.clientY*a,this.pageX=this.pageX*a,this.pageY=this.pageY*a},a.CustomSelection.Lib.Point=b}(this),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(a){"use strict";function b(a){j=a,c()}function c(){g(),i=h.getContext("2d")}function d(a){var b=a.getBoundingClientRect(),c=a.getClientRects(),d=.5,e=d-b.left,f=d-b.top;i.save(),i.translate(e,f),i.beginPath(),Array.prototype.forEach.call(c,function(a){i.rect(a.left,a.top,a.width,a.height)}),i.closePath(),i.fillStyle=j.fillStyle,i.fill(),i.restore()}function e(){return m?0:$(j.contextWindow).scrollTop()}function f(a){a=a||{top:0,left:0,width:0,height:0},h.style.top=a.top+e()+"px",h.style.left=a.left+"px",h.width=a.width,h.height=a.height}function g(){h=j.contextDocument.createElement("canvas"),h.className=k,$(h).css(l),h.width=0,h.height=0,j.$element[0].appendChild(h)}var h,i,j,k="custom-selection-canvas",l={position:"absolute","pointer-events":"none","z-index":-1},m=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;b.prototype.redraw=function(a){f(a.getBoundingClientRect()),d(a)},b.prototype.clearSelection=function(){f()},a.CustomSelection.Lib.SelectionDrawer=b}(this);
//# sourceMappingURL=jquery.custom-selection.min.map