/*! jquery-custom-selection - v0.5.2 - 2014-12-12 */
(function(){window.CustomSelection=function(){function a(a,c){this._element=a,this._settings=$.extend(b,c),this._injectDependencies(),this._contextTranslator.setContentTransformationFromMarkersContext(this._settings.contentOrigin),this._contentContext.disableNativeSelection(),this._selectionApplier.clearSelection()}var b;return b={holdThreshold:4,holdTimeout:500,markerShiftY:38,onSelectionChange:function(){},contentOrigin:{offsetX:0,offsetY:0,scale:1}},a.prototype._contentContext=null,a.prototype._contextTranslator=null,a.prototype._selectionApplier=null,a.prototype._pointerEventBinder=null,a.prototype._element=null,a.prototype._settings=null,a.prototype.refresh=function(a){return null!=a&&this._contextTranslator.setContentTransformationFromMarkersContext(a),this._selectionApplier.refreshSelection()},a.prototype.clear=function(){return this._selectionApplier.clearSelection()},a.prototype.destroy=function(){return this._selectionApplier.clearSelection(),this._pointerEventBinder.destroyBindings(),this._contentContext.restoreNativeSelection()},a.prototype._injectDependencies=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return f=this._performEnvTests(),l=new a.Lib.Utils.NodeUtil,g=new a.Lib.FrameRequester,h=new a.Lib.HammerAdapter(this._settings),this._contentContext=new a.Lib.ContentContext(this._element),this._contextTranslator=new a.Lib.ContextTranslator,b=a.Lib.Markers,w=new b.StartMarker(this._contentContext,this._contextTranslator,$(this._settings.startMarker)[0]),e=new b.EndMarker(this._contentContext,this._contextTranslator,$(this._settings.endMarker)[0]),k=new b.MovingMarker(w,e),j=new b.MarkersWrapper(w,e),b=a.Lib.Drawing,r=new b.Rectangler(f),u=new b.SelectionDrawer(r,f,this._contentContext,{fillStyle:this._settings.selectionColor,markerShiftY:this._settings.markerShiftY}),b=a.Lib.Point,n=new b.PointLocator(f,l),o=new b.PointTargetLocator(this._contentContext,l,j,n),m=new b.PointFactory(f,this._contextTranslator,o),s=new b.RightPointSnapper(m,l),c=new b.BelowPointSnapper(m,l),p=new b.PointToRangeConverter(n,this._contentContext,s,c),b=a.Lib.Range,i=new b.LastSelection,d=new b.SelectionBoundFactory(i,k),x=new b.WordRangeBuilder(l,p),v=new b.SelectionRangeBuilder(this._contentContext,p,d,k),t=new b.SelectionConstructor(this._settings,v,j,m,x,g),this._selectionApplier=new a.Lib.SelectionApplier(this._settings,i,j,u,this._contentContext),q=new a.Lib.PointerEventBus(k,this._selectionApplier,t),this._pointerEventBinder=new a.Lib.PointerEventBinder(this._element,h,j,q)},a.prototype._performEnvTests=function(){var b;return b=new a.Lib.EnvironmentChecker,{isWebkit:b.isWebkit(),isAppleDevice:b.isAppleDevice(),isAndroidLowerThanKitkat:b.isAndroidLowerThan("4.4"),isAndroidStackBrowser:b.isAndroidStackBrowser()}},a}(),window.CustomSelection.Lib={Drawing:{},Markers:{},Point:{},Range:{},Utils:{}}}).call(this),function(){!function(a){var b;return b="customSelectionInstance",a.fn.customSelection=function(a){var c;return c=new CustomSelection(this[0],a),this.first().data(b,c),this},a.fn.refreshCustomSelection=function(a){return this.first().data(b).refresh(a),this},a.fn.clearCustomSelection=function(){return this.first().data(b).clear(),this},a.fn.disableCustomSelection=function(){return this.first().data(b).destroy(),this.first().data(b,null),this}}(jQuery)}.call(this),function(){CustomSelection.Lib.ContentContext=function(){function a(a){this.container=a,this.document=this.container.ownerDocument,this.body=this.document.body,this.window=this.document.defaultView||this.document.parentWindow}return a.prototype.window=null,a.prototype.document=null,a.prototype.body=null,a.prototype.container=null,a.prototype._originalUserSelectValue=null,a.prototype.createRange=function(){return this.document.createRange()},a.prototype.createElement=function(a){return this.document.createElement(a)},a.prototype.getElementByPoint=function(a){return this.document.elementFromPoint(a.clientX,a.clientY)},a.prototype.disableNativeSelection=function(){return this._originalUserSelectValue=$(this.body).css("user-select"),$(this.body).css("user-select","none")},a.prototype.restoreNativeSelection=function(){return $(this.body).css("user-select",this._originalUserSelectValue)},a}()}.call(this),function(){CustomSelection.Lib.ContextTranslator=function(){function a(){}return a.prototype._offsetX=0,a.prototype._offsetY=0,a.prototype._scale=0,a.prototype.setBody=function(a){return this.body=a},a.prototype.setContentTransformationFromMarkersContext=function(a){return this._offsetX=a.offsetX,this._offsetY=a.offsetY,this._scale=a.scale},a.prototype.contentXToMarkerContext=function(a){return a*this._scale+this._offsetX},a.prototype.contentYToMarkerContext=function(a){return a*this._scale+this._offsetY},a.prototype.scaleToContentContext=function(a){return a/this._scale},a.prototype.markersYToContentContext=function(a){return this.scaleToContentContext(a-this._offsetY)},a.prototype.markersXToContentContext=function(a){return this.scaleToContentContext(a-this._offsetX)},a}()}.call(this),function(){CustomSelection.Lib.EnvironmentChecker=function(){function a(){}var b,c;return a.prototype.isAppleDevice=function(){return b(/(iPad|iPhone|iPod)/g)},a.prototype.isAndroidStackBrowser=function(){return this.isAndroid()&&b(/Version\/\d\.\d/g)},a.prototype.isAndroidLowerThan=function(a){var b,d,e,f,g,h;return this.isAndroid()?(h=a.split("."),f=Number(h[0]),g=Number(h[1]),e=c(/Android (\d)\.(\d)/g),b=Number(e[1]),d=Number(e[2]),f>b||b===f&&g>d):!1},a.prototype.isAndroid=function(){return b(/Android/g)},a.prototype.isWebkit=function(){return b(/WebKit/g)},c=function(a){return a.exec(window.navigator.userAgent)},b=function(a){return a.test(window.navigator.userAgent)},a}()}.call(this),function(){CustomSelection.Lib.FrameRequester=function(){function a(){}return a.prototype._ticking=!1,a.prototype.requestFrame=function(a){return this._ticking||window.requestAnimationFrame(function(b){return function(){return a(),b._ticking=!1}}(this)),this._ticking=!0},a}()}.call(this),function(){CustomSelection.Lib.HammerAdapter=function(){function a(a){this._settings=a}return a.prototype._bindings={},a.prototype._settings=null,a.prototype.bindTapHoldInElement=function(a,b){var c,d;return c=this._getBindingsFor(a),d=new Hammer.Manager(a,{recognizers:[[Hammer.Press]]}),d.set({holdThreshold:this._settings.holdThreshold,holdTimeout:this._settings.holdTimeout}),d.on("press",b),c.push(d)},a.prototype.bindTapInElement=function(a,b){var c,d;return c=this._getBindingsFor(a),d=new Hammer.Manager(a,{recognizers:[[Hammer.Tap]]}),d.on("tap",b),c.push(d)},a.prototype.destroyBindingsFor=function(a){var b,c,d,e;for(e=this._getBindingsFor(a),c=0,d=e.length;d>c;c++)b=e[c],b.destroy();return delete this._bindings[a]},a.prototype._getBindingsFor=function(a){return this._bindings[a]||(this._bindings[a]=[])},a}()}.call(this),function(){CustomSelection.Lib.PointerEventBinder=function(){function a(a,b,c,d){this._element=a,this._hammerAdapter=b,this._markersWrapper=c,this._pointerEventBus=d,this._markersWrapper.$markerElements.on("touchstart",this._pointerEventBus.handleMarkerTouchStart),this._markersWrapper.$markersBody.on("touchmove",this._pointerEventBus.handleMarkerTouchMove).on("touchend",this._pointerEventBus.handleMarkerTouchMoveEnd),$(this._element).on("touchend",this._pointerEventBus.handleGlobalTouchEnd),this._hammerAdapter.bindTapHoldInElement(this._element,this._pointerEventBus.handleGlobalTapHold),this._hammerAdapter.bindTapInElement(this._element,this._pointerEventBus.handleGlobalTap)}return a.prototype._element=null,a.prototype._hammerAdapter=null,a.prototype._markersWrapper=null,a.prototype._pointerEventBus=null,a.prototype.destroyBindings=function(){return this._markersWrapper.$markerElements.off("touchstart",this._pointerEventBus.handleMarkerTouchStart),this._markersWrapper.$markersBody.off("touchmove",this._pointerEventBus.handleMarkerTouchMove).off("touchend",this._pointerEventBus.handleMarkerTouchMoveEnd),$(this._element).off("touchend",this._pointerEventBus.handleGlobalTouchEnd),this._hammerAdapter.destroyBindingsFor(this._element)},a}()}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};CustomSelection.Lib.PointerEventBus=function(){function b(b,c,d){this._movingMarker=b,this._selectionApplier=c,this._selectionConstructor=d,this.handleGlobalTap=a(this.handleGlobalTap,this),this.handleGlobalTouchEnd=a(this.handleGlobalTouchEnd,this),this.handleMarkerTouchMoveEnd=a(this.handleMarkerTouchMoveEnd,this),this.handleMarkerTouchMove=a(this.handleMarkerTouchMove,this),this.handleMarkerTouchStart=a(this.handleMarkerTouchStart,this),this.handleGlobalTapHold=a(this.handleGlobalTapHold,this)}return b.prototype._movingMarker=null,b.prototype._selectionApplier=null,b.prototype._selectionConstructor=null,b.prototype._rejectTouchEnd=!1,b.prototype.handleGlobalTapHold=function(a){return a.srcEvent.preventDefault(),a.srcEvent.stopPropagation(),this._selectWordUnderPointer(a)},b.prototype.handleMarkerTouchStart=function(a){return a.preventDefault(),this._movingMarker.setTo(a.target)},b.prototype.handleMarkerTouchMove=function(a){return this._movingMarker.exists()?(a.preventDefault(),this._updateSelectionWithPointerMove(a),this._rejectTouchEnd=!0):void 0},b.prototype.handleMarkerTouchMoveEnd=function(){return this._movingMarker.unset()},b.prototype.handleGlobalTouchEnd=function(a){return this._rejectTouchEnd?(a.preventDefault(),this._rejectTouchEnd=!1):void 0},b.prototype.handleGlobalTap=function(){return this._selectionApplier.clearSelection()},b.prototype._selectWordUnderPointer=function(a){var b;return(b=this._selectionConstructor.getWordSelectionFrom(a))?(this._movingMarker.unset(),this._selectionApplier.clearSelection(),this._selectionApplier.applySelectionFor(b),this._rejectTouchEnd=!0):void 0},b.prototype._updateSelectionWithPointerMove=function(a){return this._selectionConstructor.getSelectionUpdatedWith(a,function(a){return function(b){return a._selectionApplier.applySelectionFor(b)}}(this))},b}()}.call(this),function(){CustomSelection.Lib.SelectionApplier=function(){function a(a,b,c,d,e){this._settings=a,this._lastSelection=b,this._markersWrapper=c,this._selectionDrawer=d,this._contentContext=e}return a.prototype._settings=null,a.prototype._lastSelection=null,a.prototype._markersWrapper=null,a.prototype._selectionDrawer=null,a.prototype._contentContext=null,a.prototype.applySelectionFor=function(a){return null!=a?(this._lastSelection.rangeEqualsTo(a)||(this._drawSelection(a),this._settings.onSelectionChange.call(null,a),this._lastSelection.range=a),this._markersWrapper.showMarkers()):void 0},a.prototype.refreshSelection=function(){return this._lastSelection.exists()?this._drawSelection(this._lastSelection.range):void 0},a.prototype.clearSelection=function(){return this._lastSelection.exists()&&(this._selectionDrawer.clearSelection(),this._settings.onSelectionChange.call(null,this._contentContext.createRange())),this._markersWrapper.hideMarkers(),this._lastSelection.range=null},a.prototype._drawSelection=function(a){return this._selectionDrawer.redraw(a),this._markersWrapper.alignMarkersToRange(a)},a}()}.call(this),function(){CustomSelection.Lib.Drawing.Rectangler=function(){function a(a){this._environment=a}return a.prototype._environment=null,a.prototype.getRectsFor=function(a){var b;return b=[].slice.call(a.getClientRects()),this._environment.isWebkit&&(b=this._filterDuplicatedRects(b)),b},a.prototype._filterDuplicatedRects=function(a){var b;return b=a[a.length-1],a.filter(this._isRectUnique.bind(this,a,b))},a.prototype._isRectUnique=function(a,b,c){return!this._rectEndsAfterLastRect(c,b)&&!this._rectContainsOneOfRects(c,a)},a.prototype._rectEndsAfterLastRect=function(a,b){var c;return c=1,a.bottom>b.bottom||a.bottom===b.bottom&&a.right-b.right>c},a.prototype._rectContainsOneOfRects=function(a,b){var c,d,e;for(d=0,e=b.length;e>d;d++)if(c=b[d],this._rectContainsNotEmptyRect(a,c))return!0;return!1},a.prototype._rectContainsNotEmptyRect=function(a,b){var c,d,e,f;return d=2,c=1,e=a,f=b,!this._rectsAreEqual(e,f)&&e.top<=f.top&&e.right>=f.right&&e.bottom>=f.bottom&&e.left<=f.left&&f.height>=c&&f.width>=d},a.prototype._rectsAreEqual=function(a,b){return a===b||a.left===b.left&&a.right===b.right&&a.height===b.height&&a.width===b.width},a}()}.call(this),function(){CustomSelection.Lib.Drawing.SelectionDrawer=function(){function a(a,b,c,d){this._rectangler=a,this._environment=b,this._contentContext=c,this._settings=d,this._canvas=this._createCanvas(),this._context=this._canvas.getContext("2d")}var b,c;return b="custom-selection-canvas",c={position:"absolute","pointer-events":"none","z-index":-1},a.prototype._rectangler=null,a.prototype._environment=null,a.prototype._contentContext=null,a.prototype._settings=null,a.prototype._canvas=null,a.prototype._context=null,a.prototype.redraw=function(a){return this._updateCanvasBounds(a.getBoundingClientRect()),this._drawSelection(a)},a.prototype.clearSelection=function(){return this._updateCanvasBounds()},a.prototype._drawSelection=function(a){var b,c,d,e,f,g,h,i;for(c=a.getBoundingClientRect(),g=this._rectangler.getRectsFor(a),b=.5,d=b-c.left,e=b-c.top,this._context.save(),this._context.translate(d,e),this._context.beginPath(),h=0,i=g.length;i>h;h++)f=g[h],this._context.rect(f.left,f.top,f.width,f.height);return this._context.closePath(),this._context.fillStyle=this._settings.fillStyle,this._context.fill(),this._context.restore()},a.prototype._yOffset=function(){return this._environment.isAppleDevice?0:$(this._contentContext.window).scrollTop()},a.prototype._updateCanvasBounds=function(a){return a=a||{top:0,left:0,width:0,height:0},this._canvas.style.top=a.top+this._yOffset()+"px",this._canvas.style.left=a.left+"px",this._canvas.width=a.width,this._canvas.height=a.height},a.prototype._createCanvas=function(){var a;return a=this._contentContext.createElement("canvas"),a.className=b,$(a).css(c),a.width=0,a.height=0,this._contentContext.container.appendChild(a),a},a}()}.call(this),function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b="jcs-marker",e="jcs-start-marker",a="jcs-end-marker",c="jcs-marker-moving",d=function(){function a(a,b,c){this._contentContext=a,this._contextTranslator=b,this.element=c||this._createMarkerElement(),this.$element=$(this.element),this.ownerBody=this.element.ownerDocument.body}return a.prototype.element=null,a.prototype.$element=null,a.prototype.ownerBody=null,a.prototype._className="",a.prototype._contentContext=null,a.prototype._contextTranslator=null,a.prototype.hide=function(){return this.$element.css({visibility:"hidden"})},a.prototype.show=function(){return this.$element.css({visibility:"visible"})},a.prototype.disablePointerEvents=function(){return this.$element.css("pointer-events","none")},a.prototype.enablePointerEvents=function(){return this.$element.css("pointer-events","auto")},a.prototype.setMoving=function(a){return this.$element.toggleClass(c,a)},a.prototype.alignToRange=function(){},a.prototype._createMarkerElement=function(){var a;return a=this._contentContext.createElement("div"),a.setAttribute("class",b+" "+this._className),a.setAttribute("style","position: absolute"),this._contentContext.container.append(a),a},a}(),CustomSelection.Lib.Markers.StartMarker=function(a){function b(){this._className=e,b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.alignToRange=function(a){var b;return b=a.getClientRects()[0],this.$element.css({left:this._contextTranslator.contentXToMarkerContext(b.left),top:this._contextTranslator.contentYToMarkerContext(b.bottom)})},b}(d),CustomSelection.Lib.Markers.EndMarker=function(b){function c(){this._className=a,c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.alignToRange=function(a){var b,c;return c=a.getClientRects(),b=c[c.length-1],this.$element.css({left:this._contextTranslator.contentXToMarkerContext(b.right),top:this._contextTranslator.contentYToMarkerContext(b.bottom)})},c}(d)}.call(this),function(){CustomSelection.Lib.Markers.MarkersWrapper=function(){function a(a,b){this._startMarker=a,this._endMarker=b,this.$markerElements=this._startMarker.$element.add(this._endMarker.$element),this.$markersBody=$(this._startMarker.ownerBody)}return a.prototype.$markerElements=null,a.prototype.$markersBody=null,a.prototype._startMarker=null,a.prototype._endMarker=null,a.prototype.showMarkers=function(){return this._startMarker.show(),this._endMarker.show()},a.prototype.hideMarkers=function(){return this._startMarker.hide(),this._endMarker.hide()},a.prototype.alignMarkersToRange=function(a){return this._startMarker.alignToRange(a),this._endMarker.alignToRange(a)},a.prototype.isMarkerElement=function(a){return a===this._startMarker.element||a===this._endMarker.element},a}()}.call(this),function(){CustomSelection.Lib.Markers.MovingMarker=function(){function a(a,b){this._startMarker=a,this._endMarker=b}return a.prototype._startMarker=null,a.prototype._endMarker=null,a.prototype._marker=null,a.prototype.setTo=function(a){return a===this._startMarker.element?this._setMovingStart():this._setMovingEnd(),this._startMarker.disablePointerEvents(),this._endMarker.disablePointerEvents()},a.prototype.toggleMoving=function(){return this.isStartMarker()?this._setMovingEnd():this.isEndMarker()?this._setMovingStart():void 0},a.prototype.unset=function(){return this._marker=null,this._unsetMovingStart(),this._unsetMovingEnd(),this._startMarker.enablePointerEvents(),this._endMarker.enablePointerEvents()},a.prototype.isStartMarker=function(){return this._marker===this._startMarker},a.prototype.isEndMarker=function(){return this._marker===this._endMarker},a.prototype.exists=function(){return null!==this._marker},a.prototype._setMovingStart=function(){return this._unsetMovingEnd(),this._marker=this._startMarker,this._startMarker.setMoving(!0)},a.prototype._setMovingEnd=function(){return this._unsetMovingStart(),this._marker=this._endMarker,this._endMarker.setMoving(!0)},a.prototype._unsetMovingStart=function(){return this._startMarker.setMoving(!1)},a.prototype._unsetMovingEnd=function(){return this._endMarker.setMoving(!1)},a}()}.call(this),function(){CustomSelection.Lib.Point.Point=function(){function a(a,b){this.clientX=a.clientX,this.clientY=a.clientY,null!=a.pageX&&(this.pageX=a.pageX),null!=a.pageY&&(this.pageY=a.pageY),this.target=b.node,this.isInText=b.isText}return a.prototype.clientX=0,a.prototype.clientY=0,a.prototype.pageX=0,a.prototype.pageY=0,a.prototype.target=null,a.prototype.isInText=!1,a}()}.call(this),function(){CustomSelection.Lib.Point.PointFactory=function(){function a(a,b,c){this._environment=a,this._contextTranslator=b,this._pointTargetLocator=c}return a.prototype._contextTranslator=null,a.prototype._environment=null,a.prototype._pointTargetLocator=null,a.prototype.createFromContentEvent=function(a){var b,c;return b=this._getPointerFromEvent(a),c=this._pointTargetLocator.getTargetFromEvent(a),new CustomSelection.Lib.Point.Point(b,c)},a.prototype.createFromMarkerEvent=function(a,b){var c,d;return c=this._getPointerFromEvent(a),this._pointerCoordsAutomaticallyScaled()||this._scalePointerCoords(c),this._shiftPointer(c,b),d=this._pointTargetLocator.getTargetByCoords(c),new CustomSelection.Lib.Point.Point(c,d)},a.prototype.createFromClientCoordsInText=function(a,b){var c;return c={node:b,isText:!0},new CustomSelection.Lib.Point.Point(a,c)},a.prototype._getPointerFromEvent=function(a){var b;return b=a.touches||a.pointers,this._clonePointer(b[0])},a.prototype._clonePointer=function(a){var b,c,d,e,f;for(c={},f=["pageX","pageY","clientX","clientY"],d=0,e=f.length;e>d;d++)b=f[d],c[b]=a[b];return c},a.prototype._pointerCoordsAutomaticallyScaled=function(){return this._environment.isAndroidStackBrowser&&this._environment.isAndroidLowerThanKitkat},a.prototype._scalePointerCoords=function(a){return a.clientX=this._contextTranslator.markersXToContentContext(a.clientX),a.clientY=this._contextTranslator.markersYToContentContext(a.clientY),a.pageX=this._contextTranslator.markersXToContentContext(a.pageX),a.pageY=this._contextTranslator.markersYToContentContext(a.pageY)},a.prototype._shiftPointer=function(a,b){return b=this._contextTranslator.scaleToContentContext(b),a.pageY=a.pageY+b,a.clientY=a.clientY+b},a}()}.call(this),function(){CustomSelection.Lib.Point.PointLocator=function(){function a(a,b){this._environment=a,this._nodeUtil=b}return a.prototype._environment=null,a.prototype._nodeUtil=null,a.prototype.rangeContainsPoint=function(a,b){var c,d,e,f;for(f=a.getClientRects(),d=0,e=f.length;e>d;d++)if(c=f[d],this._rectContainsPoint(c,b))return!0;return!1},a.prototype.nodeContainsPoint=function(a,b){var c,d,e,f;for(f=this._nodeUtil.getRectsForNode(a),d=0,e=f.length;e>d;d++)if(c=f[d],this._rectContainsPoint(c,b))return!0;return!1},a.prototype._rectContainsPoint=function(a,b){return this._rectContainsPointVertically(a,b)&&this._rectOrItsBoundsContainPointHorizontally(a,b)},a.prototype._rectContainsPointVertically=function(a,b){var c;return c=this._environment.isAppleDevice?b.pageY:b.clientY,c>a.top&&c<a.bottom},a.prototype._rectOrItsBoundsContainPointHorizontally=function(a,b){var c;return c=this._environment.isAppleDevice?b.pageX:b.clientX,c>=a.left&&c<=a.right},a}()}.call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(){function a(a,b){this._pointFactory=a,this._nodeUtil=b}return a.prototype._pointFactory=null,a.prototype._nodeUtil=null,a.prototype.snapPointToTextInElement=function(a,b){var c,d;return c=null,(d=this._searchPositionInTextByPoint(b,a))&&(c=this._createPointAt(d)),c},a.prototype._searchPositionInTextByPoint=function(a,b){var c,d;for(c=a;d=this._searchPositionWithin(c,b);){if(this._nodeUtil.nodeIsText(d.node))return d;c=d.node}return null},a.prototype._searchPositionWithin=function(a,b){var c,d,e,f,g;for(d=null,g=(null!=a?a.childNodes:void 0)||[],e=0,f=g.length;f>e;e++)c=g[e],this._nodeMightBeClosest(c)&&(d=this._getPositionCloserToPoint(d,c,b));return d},a.prototype._getPositionCloserToPoint=function(a,b,c){var d,e;return d=a,e=this._getClosestRectFromNode(b,c),this._rivalingRectWins(a,e)&&(d={node:b,rect:e}),d},a.prototype._rivalingRectWins=function(a,b){return null!=a&&this._isRivalingRectCloser(b,a.rect)||null==a&&null!=b},a.prototype._isRivalingRectCloser=function(a,b){return null!=a&&null!=b&&a!==b&&this._getCloserRect(a,b)===a},a.prototype._nodeMightBeClosest=function(a){return this._nodeUtil.nodeHasRects(a)&&(this._nodeUtil.nodeHasChildren(a)||this._nodeUtil.nodeIsText(a))},a.prototype._createPointAt=function(a){return this._pointFactory.createFromClientCoordsInText({clientX:a.rect.right-1,clientY:a.rect.bottom-1},a.node)},a}(),CustomSelection.Lib.Point.RightPointSnapper=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype._getClosestRectFromNode=function(a,b){var c,d,e,f,g;for(e=this._nodeUtil.getRectsForNode(a),c=null,f=0,g=e.length;g>f;f++)d=e[f],this._rectIsInTheSameLineOnLeft(d,b)&&(!c||d.right>c.right)&&(c=d);return c},b.prototype._getCloserRect=function(a,b){return a.right>b.right?a:b.right>a.right?b:null},b.prototype._rectIsInTheSameLineOnLeft=function(a,b){var c,d;return c=b.clientX,d=b.clientY,a.right<c&&a.top<=d&&a.bottom>=d},b}(a),CustomSelection.Lib.Point.BelowPointSnapper=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype._getClosestRectFromNode=function(a,b){var c,d,e,f,g,h;for(f=b.clientY,e=this._nodeUtil.getRectsForNode(a),c=null,g=0,h=e.length;h>g;g++)d=e[g],d.top<f&&(!c||d.top>=c.top)&&(c=d);return c},b.prototype._getCloserRect=function(a,b){return a.top>=b.top?a:b.top>a.top?b:null},b}(a)}.call(this),function(){CustomSelection.Lib.Point.PointTargetLocator=function(){function a(a,b,c,d){this._contentContext=a,this._nodeUtil=b,this._markersWrapper=c,this._pointLocator=d}return a.prototype._contentContext=null,a.prototype._nodeUtil=null,a.prototype._markersWrapper=null,a.prototype._pointLocator=null,a.prototype.getTargetFromEvent=function(a){var b,c;return b=this._getPointerFromEvent(a),c=this._locateTextNodeWithinElementByCoords(b.target,b),{node:c||b.target,isText:null!=c}},a.prototype.getTargetByCoords=function(a){var b,c;return b=this._getTargetElementByCoords(a),c=this._locateTextNodeWithinElementByCoords(b,a),{node:c||b,isText:null!=c}},a.prototype._getTargetElementFromPointerEvent=function(a){return this._getPointerFromEvent(a).target},a.prototype._getTargetElementByCoords=function(a){var b;return this._markersWrapper.hideMarkers(),b=this._contentContext.getElementByPoint(a)||this._contentContext.body,this._markersWrapper.showMarkers(),b},a.prototype._getPointerFromEvent=function(a){return(a.touches||a.pointers)[0]},a.prototype._locateTextNodeWithinElementByCoords=function(a,b){var c,d,e,f;for(d=a.childNodes,e=0,f=d.length;f>e;e++)if(c=d[e],this._isPointerInText(c,b))return c;return null},a.prototype._isPointerInText=function(a,b){return this._nodeUtil.nodeIsText(a)&&this._pointLocator.nodeContainsPoint(a,b)},a}()}.call(this),function(){CustomSelection.Lib.Point.PointToRangeConverter=function(){function a(a,b,c,d){this._pointLocator=a,this._contentContext=b,this._rightPointSnapper=c,this._belowPointSnapper=d}return a.prototype._pointLocator=null,a.prototype._contentContext=null,a.prototype._rightPointSnapper=null,a.prototype._belowPointSnapper=null,a.prototype.pointToRange=function(a){var b,c,d,e,f;for(e=this._contentContext.createRange(),f=0,c=a.target.data.length,b=c;b>f;)d=f+b>>1,e.setStart(a.target,f),e.setEnd(a.target,d+1),this._pointLocator.rangeContainsPoint(e,a)?b=d:(f=d+1,e.setStart(a.target,f),e.setEnd(a.target,b));return e.collapsed&&e.endOffset<c&&e.setEnd(a.target,e.endOffset+1),e},a.prototype.pointToRangeAnchor=function(a){var b;return b=null,a.isInText?b=this._getStartAnchorOf(this.pointToRange(a)):(a=this._snapPointToText(a))&&(b=this._getEndAnchorOf(this.pointToRange(a))),b},a.prototype._snapPointToText=function(a){return this._rightPointSnapper.snapPointToTextInElement(a,a.target)||this._belowPointSnapper.snapPointToTextInElement(a,a.target)},a.prototype._getStartAnchorOf=function(a){return{container:a.startContainer,offset:a.startOffset}},a.prototype._getEndAnchorOf=function(a){return{container:a.endContainer,offset:a.endOffset}},a}()}.call(this),function(){CustomSelection.Lib.Range.LastSelection=function(){function a(){}return a.prototype.range=null,a.prototype.cloneRange=function(){return this.range.cloneRange()},a.prototype.exists=function(){return null!=this.range&&null!=this.range.getBoundingClientRect()&&this.range.getClientRects().length>0},a.prototype.rangeEqualsTo=function(a){return null!=this.range&&this._hasSameStartAs(a)&&this._hasSameEndAs(a)},a.prototype._hasSameStartAs=function(a){return 0===this.range.compareBoundaryPoints(Range.START_TO_START,a)},a.prototype._hasSameEndAs=function(a){return 0===this.range.compareBoundaryPoints(Range.END_TO_END,a)},a}()}.call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(){function a(a){this._container=a.container,this._offset=a.offset}return a.prototype._container=null,a.prototype._offset=null,a}(),CustomSelection.Lib.Range.StartBoundary=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.applyTo=function(a){return a.setStart(this._container,this._offset)},b.prototype.applyOppositeTo=function(a){return a.setEnd(this._container,this._offset)},b}(a),CustomSelection.Lib.Range.EndBoundary=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.applyTo=function(a){return a.setEnd(this._container,this._offset)},b.prototype.applyOppositeTo=function(a){return a.setStart(this._container,this._offset)},b}(a)}.call(this),function(){CustomSelection.Lib.Range.SelectionBoundFactory=function(){function a(a,b){this._lastSelection=a,this._movingMarker=b}return a.prototype._lastSelection=null,a.prototype._movingMarker=null,a.prototype.getProtectedSelectionBound=function(){return this._movingMarker.isStartMarker()?this._createEndBoundary({container:this._lastSelection.range.endContainer,offset:this._lastSelection.range.endOffset}):this._createStartBoundary({container:this._lastSelection.range.startContainer,offset:this._lastSelection.range.startOffset})},a.prototype.getMovingSelectionBound=function(a){return this._movingMarker.isEndMarker()?this._createEndBoundary(a):this._createStartBoundary(a)},a.prototype._createEndBoundary=function(a){return new CustomSelection.Lib.Range.EndBoundary(a)},a.prototype._createStartBoundary=function(a){return new CustomSelection.Lib.Range.StartBoundary(a)},a}()}.call(this),function(){CustomSelection.Lib.Range.SelectionConstructor=function(){function a(a,b,c,d,e,f){this._settings=a,this._selectionRangeBuilder=b,this._markersWrapper=c,this._pointFactory=d,this._wordRangeBuilder=e,this._frameRequester=f}return a.prototype._settings=null,a.prototype._selectionRangeBuilder=null,a.prototype._markersWrapper=null,a.prototype._pointFactory=null,a.prototype._wordRangeBuilder=null,a.prototype._frameRequester=null,a.prototype._lastPoint=null,a.prototype.getWordSelectionFrom=function(a){var b,c,d;return d=null,b=a.pointers[0].target,this._markersWrapper.isMarkerElement(b)||(c=this._pointFactory.createFromContentEvent(a),d=this._wordRangeBuilder.getRangeOfWordUnderPoint(c)),d},a.prototype.getSelectionUpdatedWith=function(a,b){return this._lastPoint=this._pointFactory.createFromMarkerEvent(a.originalEvent,-this._settings.markerShiftY),this._frameRequester.requestFrame(function(a){return function(){var c;return c=a._selectionRangeBuilder.getRangeUpdatedWithPoint(a._lastPoint),b(c)}}(this))},a}()}.call(this),function(){CustomSelection.Lib.Range.SelectionRangeBuilder=function(){function a(a,b,c,d){this._contentContext=a,this._pointToRangeConverter=b,this._selectionBoundFactory=c,this._movingMarker=d}return a.prototype._contentContext=null,a.prototype._pointToRangeConverter=null,a.prototype._selectionBoundFactory=null,a.prototype._movingMarker=null,a.prototype.getRangeUpdatedWithPoint=function(a){var b,c,d,e;return c=null,(b=this._pointToRangeConverter.pointToRangeAnchor(a))&&(c=this._contentContext.createRange(),d=this._selectionBoundFactory.getMovingSelectionBound(b),e=this._selectionBoundFactory.getProtectedSelectionBound(),d.applyTo(c),e.applyTo(c),c.collapsed&&(e.applyOppositeTo(c),d.applyOppositeTo(c),this._movingMarker.toggleMoving())),c},a}()}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};CustomSelection.Lib.Range.WordRangeBuilder=function(){function b(a,b){this._nodeUtil=a,this._pointToRangeConverter=b}var c;return c=[" ","	","\r","\n"],b.prototype._nodeUtil=null,b.prototype._pointToRangeConverter=null,b.prototype.getRangeOfWordUnderPoint=function(a){var b;return b=null,a.isInText&&(b=this._pointToRangeConverter.pointToRange(a),this._expandRangeToStartAfterTheWhitespaceOnLeft(b),this._expandRangeToEndBeforeTheWhitespaceOnRight(b)),b},b.prototype._expandRangeToStartAfterTheWhitespaceOnLeft=function(a){for(;!this._rangeStartsWithWhitespace(a);)if(a.startOffset>0)a.setStart(a.startContainer,a.startOffset-1);else if(!this._putRangeStartAtTheEndOfPreviousTextNode(a))return;return a.setStart(a.startContainer,a.startOffset+1),this._rangeStartsOnWhitespaceAtTheEndOfNode(a)?a.setStart(this._nodeUtil.getTextNodeAfter(a.startContainer),0):void 0},b.prototype._expandRangeToEndBeforeTheWhitespaceOnRight=function(a){for(var b;!this._rangeEndsWithWhitespace(a);)if(b=a.endContainer.data.length,a.endOffset<b)a.setEnd(a.endContainer,a.endOffset+1);
else if(!this._putRangeEndAtTheBeginningOfNextTextNode(a))return;return a.setEnd(a.endContainer,Math.max(a.endOffset-1,0))},b.prototype._rangeStartsWithWhitespace=function(b){var d;return d=b.toString()[0],a.call(c,d)>=0},b.prototype._rangeEndsWithWhitespace=function(b){var d,e;return e=b.toString(),d=e[e.length-1],a.call(c,d)>=0},b.prototype._putRangeStartAtTheEndOfPreviousTextNode=function(a){var b;return(b=this._nodeUtil.getTextNodeBefore(a.startContainer))?(a.setStart(b,b.data.length),!0):!1},b.prototype._putRangeEndAtTheBeginningOfNextTextNode=function(a){var b;return(b=this._nodeUtil.getTextNodeAfter(a.endContainer))?(a.setEnd(b,0),!0):!1},b.prototype._rangeStartsOnWhitespaceAtTheEndOfNode=function(a){return this._nodeEndsWithWhitespace(a.startContainer)&&(a.startOffset===a.startContainer.data.length||a.startOffset===a.startContainer.data.length-1)},b.prototype._nodeEndsWithWhitespace=function(b){var d;return d=b.data[b.data.length-1],a.call(c,d)>=0},b}()}.call(this),function(){CustomSelection.Lib.Utils.NodeUtil=function(){function a(){}return a.prototype.nodeIsText=function(a){return a.nodeType===Node.TEXT_NODE&&a.length>0},a.prototype.getRectsForNode=function(a){var b;return b=a.ownerDocument.createRange(),b.selectNode(a),b.getClientRects()},a.prototype.nodeHasRects=function(a){return this.getRectsForNode(a).length>0},a.prototype.nodeHasChildren=function(a){return a.childNodes.length>0},a.prototype.getTextNodeAfter=function(a){for(var b;;){if(this.nodeHasChildren(a))a=a.childNodes[0];else if(a.nextSibling)a=a.nextSibling;else{if(!(b=this._getSiblingAfterParentOf(a)))return null;a=b}if(this.nodeIsText(a))break}return a},a.prototype.getTextNodeBefore=function(a){for(var b;;){if(this.nodeHasChildren(a))a=a.childNodes[a.childNodes.length-1];else if(a.previousSibling)a=a.previousSibling;else{if(!(b=this._getSiblingBeforeParentOf(a)))return null;a=b}if(this.nodeIsText(a))break}return a},a.prototype._getSiblingAfterParentOf=function(a){var b;for(b=a.ownerDocument.body;!a.nextSibling;){if(a===b)return null;a=a.parentNode}return a.nextSibling},a.prototype._getSiblingBeforeParentOf=function(a){var b;for(b=a.ownerDocument.body;!a.previousSibling;){if(a===b)return null;a=a.parentNode}return a.previousSibling},a}()}.call(this),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();
//# sourceMappingURL=jquery.custom-selection.min.map