{"version":3,"file":"jquery.custom-selection.min.js","sources":["jquery.custom-selection.js"],"names":["$","useContextOf","$element","contextDocument","ownerDocument","contextWindow","getWindowOf","initializeHammerFor","hammer","Hammer","Manager","recognizers","Press","Tap","set","holdThreshold","settings","holdTimeout","enableTouchSelectionFor","startMarker","add","endMarker","on","handleMarkerTouchStart","getBodyOf","handleMarkerTouchMove","handleMarkerTouchMoveEnd","handleGlobalTouchEnd","handleGlobalTapHold","clearSelection","disableTouchSelectionFor","off","destroy","e","srcEvent","preventDefault","stopPropagation","selectWordUnderPointer","jqueryEvent","rejectTouchEnd","handleMarkerPointerMove","lastPoint","createPointFromMarkerEvent","originalEvent","frameRequester","requestFrame","eventTarget","getTouchedElementByPoint","range","getRangeCoveringLastSelectionAndPointInElement","makeSelectionFor","setMovedMarker","target","disableMarkerEvents","selectionAnchor","getSelectionAnchor","movedMarker","unsetMovedMarker","enableMarkerEvents","element","body","doc","defaultView","parentWindow","getEndAnchorOf","lastSelectionRange","getStartAnchorOf","disableNativeSelectionFor","userSelectBeforeEnablingSelection","css","restoreNativeSelectionFor","pointerEvent","getTargetElementFromPointerEvent","isMarker","point","createPointFromEvent","getRangeWrappingWordAtPoint","rangeDiffersFromLastSelection","drawSelectionRange","onSelectionChange","showMarkers","doesRangeExist","hideMarkers","selectionDrawer","createRange","refreshSelection","redraw","adjustMarkerPositionsTo","hasEndOtherThanLastSelectionEnd","compareBoundaryPoints","Range","END_TO_END","hasStartOtherThanLastSelectionStart","START_TO_START","rects","getClientRects","firstRect","lastRect","length","top","yToMarkersContext","bottom","left","xToMarkersContext","right","getBoundingClientRect","initMarkers","createMarkerInside","MARKER_START_CLASS","MARKER_END_CLASS","addClass","MARKER_MOVING_CLASS","removeClass","toggleMovedMarker","shiftY","markerShiftY","eventCoordsAutomaticallyConverted","scaleOffset","getScaleOfMarkersContext","translate","getVectorOfMarkersOrigin","scale","options","CustomSelection","Lib","Point","origin","contextOrigin","x","offsetX","y","offsetY","touches","pointers","touchPoint","elementFromPoint","clientX","clientY","$parent","className","createElement","setAttribute","MARKER_CLASS","append","visibility","environment","isAndroidStackBrowser","isAndroidLowerThanKitkat","performEnvTests","env","EnvironmentChecker","isWebkit","isAppleDevice","isAndroidLowerThan","textNode","getFromElNodeContainingPoint","getFromTextNodeMinimalRangeContainingPoint","expandRangeToStartAfterTheWhitespaceOnLeft","expandRangeToEndBeforeTheWhitespaceOnRight","rangeStartsWithWhitespace","startOffset","setStart","startContainer","putRangeStartAtTheEndOfPreviousTextNode","rangeStartsOnWhitespaceAtTheEndOfNode","getTextNodeAfter","rangeEndsWithWhitespace","maxIndex","endContainer","data","endOffset","setEnd","putRangeEndAtTheBeginningOfNextTextNode","Math","max","toString","charCodeAt","WHITESPACE_LIST","stringified","newStartContainer","getTextNodeBefore","newEndContainer","nodeEndsWithWhitespace","node","coveringRange","cloneRange","pointAnchor","convertPointInElementToAnchor","bound","getNewSelectionBoundary","protectedBound","getProtectedSelectionBoundary","applyTo","collapsed","applyOppositeTo","anchor","createStartBoundary","createEndBoundary","pointRange","getPointRangeFromElement","getClosestPointRangeFormElement","startIndex","endIndex","middle","rangeContainsPoint","StartBoundary","EndBoundary","container","offset","el","n","nodes","childNodes","i","nodeIsText","nodeContainsPoint","rect","j","rectContainsPoint","getRectsForNode","selectNode","rectContainsPointVertically","rectOrItsBoundsContainPointHorizontally","pageY","pageX","nodeType","Node","TEXT_NODE","nodeHasChildren","getSiblingAfterParentOf","nextSibling","parentNode","getSiblingBeforeParentOf","previousSibling","uncle","nearestOnTheLeftOfPoint","createNodeComparator","getBetterRect","getRectMoreOnTheRight","getBestRectFromNode","getRectNearestOnLeftOfPoint","nearestAbovePoint","getLowerRect","getRectNearestAbovePoint","closestNodeFound","searchTextNode","createRangeAtTheEndOfTheClosestNode","setClosestNodeAndRect","closestNode","closestRectInNode","comparator","subNode","searchNode","bestNode","winner","rival","newWinner","nearestRivalRect","nearestWinnerRect","areDifferent","rectA","rectB","nearestRect","rectIsInTheSameLineOnLeft","arg1","arg2","lastRectInNode","document","pointAtRightBoundaryOfRect","defaults","window","fn","customSelection","extend","this","FrameRequester","SelectionDrawer","fillStyle","selectionColor","refreshCustomSelection","clearCustomSelection","disableCustomSelection",32,9,13,10,"jQuery","global","Boundary","_container","_offset","apply","arguments","prototype","Object","create","userAgent","navigator","userAgentMatch","regExp","exec","testUserAgent","test","isAndroid","versionString","expectedVersion","split","expectedMajor","Number","expectedMinor","actualVersion","actualMajor","actualMinor","_ticking","func","requestAnimationFrame","bind","_settings","touch","vector","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","id","setTimeout","clearTimeout","initCanvas","createCanvas","context","canvas","getContext","drawSelection","boundingClientRect","SUBPIXEL_OFFSET","save","beginPath","forEach","width","height","closePath","fill","restore","yOffset","scrollTop","updateCanvasBounds","newBounds","style","CUSTOM_SELECTION_CANVAS_CLASS","CUSTOM_SELECTION_CANVAS_STYLE","appendChild","slice","call","filterDuplicatedRects","filter","rectEndsAfterLastRect","rectContainsOneOfRects","TOLERATED_RIGHT_LEAK","rectContainsNotEmptyRect","possibleParent","potentialChild","MINIMAL_RECT_WIDTH","MINIMAL_RECT_HEIGHT","R","r","rectsAreEqual","position","pointer-events","z-index","match"],"mappings":"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"}