{"version":3,"file":"jquery.custom-selection.min.js","sources":["jquery.custom-selection.js"],"names":["$","useContextOf","$element","contextDocument","ownerDocument","contextWindow","getWindowOf","initializeHammerFor","hammer","Hammer","Manager","recognizers","Press","Tap","set","holdThreshold","settings","holdTimeout","enableTouchSelectionFor","startMarker","add","endMarker","on","handleMarkerTouchStart","getBodyOf","handleMarkerTouchMove","handleMarkerTouchMoveEnd","handleGlobalTouchEnd","handleGlobalTapHold","clearSelection","disableTouchSelectionFor","off","destroy","e","srcEvent","preventDefault","stopPropagation","selectWordUnderPointer","jqueryEvent","rejectTouchEnd","handleMarkerPointerMove","lastPoint","createPointFromMarkerEvent","originalEvent","frameRequester","requestFrame","eventTarget","getTouchedElementByPoint","range","getRangeCoveringLastSelectionAndPointInElement","makeSelectionFor","setMovedMarker","target","disableMarkerEvents","selectionAnchor","getSelectionAnchor","movedMarker","unsetMovedMarker","enableMarkerEvents","element","body","doc","defaultView","parentWindow","getEndAnchorOf","lastSelectionRange","getStartAnchorOf","disableNativeSelectionFor","userSelectBeforeEnablingSelection","css","restoreNativeSelectionFor","pointerEvent","getTargetElementFromPointerEvent","isMarker","point","createPointFromEvent","shift","getRangeWrappingWordAtPoint","rangeDiffersFromLastSelection","drawSelectionRange","onSelectionChange","showMarkers","doesRangeExist","hideMarkers","selectionDrawer","createRange","refreshSelection","redraw","adjustMarkerPositionsTo","hasEndOtherThanLastSelectionEnd","compareBoundaryPoints","Range","END_TO_END","hasStartOtherThanLastSelectionStart","START_TO_START","rects","getClientRects","firstRect","lastRect","length","top","yToMarkersContext","bottom","left","xToMarkersContext","right","getBoundingClientRect","initMarkers","createMarkerInside","MARKER_START_CLASS","MARKER_END_CLASS","addClass","MARKER_MOVING_CLASS","removeClass","toggleMovedMarker","shouldConvertPointerEvent","translate","getVectorOfMarkersOrigin","scale","getScaleOfMarkersContext","options","CustomSelection","Lib","Point","origin","contextOrigin","x","offsetX","y","offsetY","touches","pointers","touchPoint","elementFromPoint","clientX","clientY","$parent","className","createElement","setAttribute","MARKER_CLASS","append","visibility","environment","isAndroidLowerThanKitkat","isAndroidStackBrowser","performEnvTests","env","EnvironmentChecker","isWebkit","isAppleDevice","isAndroidLowerThan","textNode","getFromElNodeContainingPoint","getFromTextNodeMinimalRangeContainingPoint","expandRangeToStartAfterTheWhitespaceOnLeft","expandRangeToEndBeforeTheWhitespaceOnRight","rangeStartsWithWhitespace","startOffset","setStart","startContainer","maxIndex","Math","max","endContainer","data","rangeEndsWithWhitespace","endOffset","setEnd","toString","charCodeAt","WHITESPACE_LIST","stringified","coveringRange","cloneRange","pointAnchor","convertPointInElementToAnchor","bound","getNewSelectionBoundary","protectedBound","getProtectedSelectionBoundary","applyTo","collapsed","applyOppositeTo","anchor","createStartBoundary","createEndBoundary","pointRange","getPointRangeFromElement","getClosestPointRangeFormElement","startIndex","endIndex","middle","rangeContainsPoint","StartBoundary","EndBoundary","container","offset","el","n","nodes","childNodes","i","nodeIsText","nodeContainsPoint","rect","j","rectContainsPoint","node","getRectsForNode","selectNode","rectContainsPointVertically","rectOrItsBoundsContainPointHorizontally","pageY","pageX","nodeType","Node","TEXT_NODE","nodeHasChildren","nearestOnTheLeftOfPoint","createNodeComparator","getBetterRect","getRectMoreOnTheRight","getBestRectFromNode","getRectNearestOnLeftOfPoint","nearestAbovePoint","getLowerRect","getRectNearestAbovePoint","closestNodeFound","searchTextNode","createRangeAtTheEndOfTheClosestNode","setClosestNodeAndRect","closestNode","closestRectInNode","comparator","subNode","searchNode","winner","rival","newWinner","nearestRivalRect","nearestWinnerRect","areDifferent","rectA","rectB","nearestRect","rectIsInTheSameLineOnLeft","arg1","arg2","lastRectInNode","document","pointAtRightBoundaryOfRect","defaults","window","fn","customSelection","extend","this","FrameRequester","SelectionDrawer","fillStyle","selectionColor","refreshCustomSelection","clearCustomSelection","disableCustomSelection",32,9,13,10,"jQuery","global","Boundary","_container","_offset","apply","arguments","prototype","Object","create","userAgent","navigator","userAgentMatch","regExp","exec","testUserAgent","test","isAndroid","versionString","expectedVersion","split","expectedMajor","Number","expectedMinor","actualVersion","actualMajor","actualMinor","_ticking","func","requestAnimationFrame","bind","touch","SHIFT_Y","vector","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","id","setTimeout","clearTimeout","initCanvas","createCanvas","context","canvas","getContext","drawSelection","boundingClientRect","SUBPIXEL_OFFSET","save","beginPath","forEach","width","height","closePath","fill","restore","yOffset","scrollTop","updateCanvasBounds","newBounds","style","CUSTOM_SELECTION_CANVAS_CLASS","CUSTOM_SELECTION_CANVAS_STYLE","appendChild","slice","call","filterDuplicatedRects","filter","rectEndsAfterLastRect","rectContainsOneOfRects","TOLERATED_RIGHT_LEAK","rectContainsNotEmptyRect","possibleParent","potentialChild","R","r","rectsAreEqual","position","pointer-events","z-index","match"],"mappings":"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"}