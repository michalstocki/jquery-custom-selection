{"version":3,"file":"jquery.custom-selection.min.js","sources":["jquery.custom-selection.js"],"names":["$","hammerAllowTextSelection","Hammer","defaults","cssProps","userSelect","useContextOf","$element","contextDocument","ownerDocument","contextWindow","defaultView","parentWindow","enableTouchSelectionFor","each","this","holdThreshold","holdTimeout","on","handleGlobalTouchMove","handleGlobalTouchEnd","hammer","handleGlobalTapHold","clearSelection","disableTouchSelectionFor","off","e","gesture","srcEvent","preventDefault","stopPropagation","isMarker","target","element","getTouchedElementFromEvent","point","getTouchPoint","shift","wrapWithMarkersWordAtPoint","createSelection","rejectTouchEnd","jqueryEvent","handleMarkerTouchMove","lastPoint","originalEvent","frameRequester","requestFrame","eventAnchor","getTouchedElementByPoint","mark","updateSelection","startMarker","endMarker","getSelection","removeAllRanges","detach","existInDOM","range","createRange","setStart","apply","getRangeBoundAt","setEnd","collapsed","addRange","offset","getIndexOfElement","anchor","parentNode","nextSibling","i","arguments","length","touchEvent","options","CustomSelection","Lib","Point","touches","pointers","touchPoint","hideMarkers","elementFromPoint","clientX","clientY","showMarkers","createMarker","kind","span","createElement","setAttribute","css","visibility","textNode","getFromElNodeContainingPoint","trimTextNodeWhileContainsPoint","putMarkerBeforeWhitespaceOnLeftOf","putMarkerBeforeWhitespaceOnRightOf","normalize","marker","node","nodeEndsWith","WHITESPACE","data","removeLastLetter","previousSibling","nodeIsText","putMarkerBefore","putMarkerAfter","nodeStartsWith","removeFirstLetter","subNode","splitText","letter","el","getClosestTextNodeFromEl","trimPosition","nodeContainsPoint","insertBefore","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","nodeHasChildren","getClosestTextNodeOnLeftOfPoint","getClosestTextNodeAbovePoint","getClosestNodeFromElOnLeftOfPoint","closestNode","getNodeCloserOnLeftOfPoint","winner","rival","newWinner","nearestRivalRect","getRectNearestOnLeftOfPoint","nearestWinnerRect","splitNodeAfterRect","nearestRect","clientRect","lastRect","getClosestNodeFromElAbovePoint","getNodeCloserAbovePoint","getRectNearestAbovePoint","settings","markerClass","window","fn","customSelection","extend","FrameRequester","disableCustomSelection","jQuery","global","_ticking","func","requestAnimationFrame","bind","touch","pageX","pageY","SHIFT_Y","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout"],"mappings":"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"}