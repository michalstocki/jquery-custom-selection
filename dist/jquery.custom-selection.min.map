{"version":3,"file":"jquery.custom-selection.min.js","sources":["jquery.custom-selection.js"],"names":["$","hammerAllowTextSelection","Hammer","defaults","cssProps","userSelect","useContextOf","$element","contextDocument","ownerDocument","contextWindow","defaultView","parentWindow","enableTouchSelectionFor","each","this","holdThreshold","holdTimeout","on","handleGlobalTouchMove","handleGlobalTouchEnd","hammer","handleGlobalTapHold","clearSelection","disableTouchSelectionFor","off","e","gesture","srcEvent","preventDefault","stopPropagation","isMarker","target","element","getTouchedElementFromEvent","point","getTouchPoint","shift","wrapWithMarkersWordAtPoint","createSelection","rejectTouchEnd","jqueryEvent","handleMarkerTouchMove","lastPoint","originalEvent","frameRequester","requestFrame","eventAnchor","getTouchedElementByPoint","mark","updateSelection","startMarker","endMarker","getSelection","removeAllRanges","detach","existInDOM","range","createRange","setStart","apply","getRangeBoundAt","setEnd","collapsed","addRange","offset","Math","max","getIndexOfElement","anchor","parentNode","i","arguments","length","touchEvent","options","CustomSelection","Lib","Point","touches","pointers","touchPoint","hideMarkers","elementFromPoint","clientX","clientY","showMarkers","createMarker","kind","span","createElement","setAttribute","css","visibility","textNode","getFromElNodeContainingPoint","trimTextNodeWhileContainsPoint","putMarkerBeforeWhitespaceOnLeftOf","putMarkerBeforeWhitespaceOnRightOf","normalize","marker","node","nodeEndsWith","WHITESPACE","data","removeLastLetter","previousSibling","nodeIsText","putMarkerBefore","putMarkerAfter","nodeStartsWith","removeFirstLetter","nextSibling","subNode","splitText","letter","el","getClosestTextNodeFromEl","trimPosition","nodeContainsPoint","insertBefore","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","settings","markerClass","window","fn","customSelection","extend","FrameRequester","disableCustomSelection","jQuery","global","_ticking","func","requestAnimationFrame","bind","touch","pageX","pageY","SHIFT_Y","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","id","setTimeout","clearTimeout"],"mappings":"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"}