{"version":3,"file":"custom-selection.min.js","sources":["custom-selection.js"],"names":["global","bindTouchFor","element","$","on","handleTouchStart","handleTouchMove","handleTouchEnd","unbindTouchFor","off","e","originalEvent","clearSelection","eventAnchor","getTouchedElementFromEvent","point","getTouchPoint","markStart","preventDefault","lastPoint","frameRequester","requestFrame","getTouchedElementByPoint","markEnd","createSelection","window","getSelection","removeAllRanges","startMarkerClass","remove","endMarkerClass","startMarker","parentNode","endMarker","range","document","createRange","startAnchor","endAnchor","startOffset","getIndexOfElement","endOffset","setStart","setEnd","collapsed","addRange","console","log","touchEvent","CustomSelection","Lib","Point","touches","target","touchPoint","elementFromPoint","clientX","clientY","createMarker","mark","kind","span","createElement","setAttribute","el","marker","textNode","getFromElNodeContainingPoint","length","trimPosition","subNode","splitText","nodeContainsPoint","putMarkerBefore","getClosestTextNodeFromEl","putMarkerAfter","normalize","node","insertBefore","nextSibling","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","i","nodeIsText","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","enable","options","FrameRequester","disable","this","_ticking","func","requestAnimationFrame","bind","touch","pageX","pageY","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout"],"mappings":";CACA,SAAUA,GAkCT,QAASC,GAAaC,GACrBC,EAAED,GACAE,GAAG,aAAcC,GACjBD,GAAG,YAAaE,GAChBF,GAAG,WAAYG,GAGlB,QAASC,GAAeN,GACvBC,EAAED,GACAO,IAAI,aAAcJ,GAClBI,IAAI,YAAaH,GACjBG,IAAI,WAAYF,GAGnB,QAASF,GAAiBK,GACzBA,EAAIA,EAAEC,cACNC,GACA,IAAIC,GAAcC,EAA2BJ,GACzCK,EAAQC,EAAcN,EAC1BO,GAAUJ,EAAaE,GAGxB,QAAST,GAAgBI,GACxBA,EAAEQ,iBACFR,EAAIA,EAAEC,cACNQ,EAAYH,EAAcN,GAC1BU,EAAeC,aAAa,WAC3B,GAAIR,GAAcS,EAAyBH,EAC3CI,GAAQV,EAAaM,KAIvB,QAASZ,KACRiB,IAKD,QAASZ,KACRa,OAAOC,eAAeC,kBACtBxB,EAAE,IAAMyB,GAAkBC,SAC1B1B,EAAE,IAAM2B,GAAgBD,SAGzB,QAASL,KACR,IAAKO,EAAYC,aAAeC,EAAUD,WACzC,MAAO,KAER,IAAIE,GAAQC,SAASC,cACjBC,EAAcN,EAAYC,WAC1BM,EAAYL,EAAUD,WACtBO,EAAcC,EAAkBT,GAChCU,EAAYD,EAAkBP,EAClCC,GAAMQ,SAASL,EAAaE,GAC5BL,EAAMS,OAAOL,EAAWG,GACpBP,EAAMU,YACTV,EAAMQ,SAASJ,EAAWG,GAC1BP,EAAMS,OAAON,EAAaE,IAE3Bd,OAAOC,eAAemB,SAASX,GAC/BY,QAAQC,IAAI,iBAAkBV,EAAaC,EAAWC,EAAaE,GAKpE,QAASzB,GAAcgC,GACtB,MAAO,IAAIC,iBAAgBC,IAAIC,MAAMH,GAGtC,QAASlC,GAA2BkC,GACnC,MAAOA,GAAWI,QAAQ,GAAGC,OAG9B,QAAS/B,GAAyBgC,GACjC,MAAOnB,UAASoB,iBAAiBD,EAAWE,QAASF,EAAWG,SAGjE,QAASxC,GAAUf,EAASa,GAC3BgB,EAAcA,GAAe2B,EAAa9B,GAC1C+B,EAAKzD,EAASa,EAAOgB,GAGtB,QAASR,GAAQrB,EAASa,GACzBkB,EAAYA,GAAayB,EAAa5B,GACtC6B,EAAKzD,EAASa,EAAOkB,GAGtB,QAASyB,GAAaE,GACrB,GAAIC,GAAO1B,SAAS2B,cAAc,OAElC,OADAD,GAAKE,aAAa,QAASH,GACpBC,EAMR,QAASF,GAAKK,EAAIjD,EAAOkD,GACxB,GAAIC,EACJ,IAAIA,EAAWC,EAA6BH,EAAIjD,GAAQ,CACvD,KAAOmD,EAASE,OAAS,GAAG,CAC3B,GAAIC,GAAeH,EAASE,QAAU,EAClCE,EAAUJ,EAASK,UAAUF,EAC7BG,GAAkBF,EAASvD,KAC9BmD,EAAWI,GAGbG,EAAgBP,EAAUD,OACpB,CAAA,KAAIC,EAAWQ,EAAyBV,EAAIjD,IAGlD,MAAO,KAFP4D,GAAeT,EAAUD,GAI1BA,EAAOjC,WAAW4C,YAGnB,QAASH,GAAgBI,EAAMZ,GAC9BY,EAAK7C,WAAW8C,aAAab,EAAQY,GAGtC,QAASF,GAAeE,EAAMZ,GACzBY,EAAKE,YACRF,EAAK7C,WAAW8C,aAAab,EAAQY,EAAKE,aAE1CF,EAAK7C,WAAWgD,YAAYf,GAI9B,QAASzB,GAAkBtC,GAC1B,GAAI+E,GAAW/E,EAAQgF,cAAcC,UACrC,OAAOC,OAAMC,UAAUC,QAAQC,KAAKN,EAAU/E,GAM/C,QAASiE,GAA6BH,EAAIjD,GAEzC,IAAK,GAAWyE,GADZC,EAAQzB,EAAGmB,WACNO,EAAI,EAAMF,EAAIC,EAAMC,MAC5B,GAAIC,EAAWH,IAAMhB,EAAkBgB,EAAGzE,GACzC,MAAOyE,GAKV,QAAShB,GAAkBK,EAAM9D,GAEhC,IAAK,GAAW6E,GADZC,EAAQC,EAAgBjB,GACnBkB,EAAI,EAASH,EAAOC,EAAME,MAClC,GAAIC,EAAkBJ,EAAM7E,GAC3B,OAAO,EAKV,QAAS+E,GAAgBjB,GACxB,GAAI3C,GAAQC,SAASC,aAErB,OADAF,GAAM+D,WAAWpB,GACV3C,EAAMgE,iBAGd,QAASF,GAAkBJ,EAAM7E,GAChC,GAAIoF,GAAIpF,EAAMyC,QAAS4C,EAAIrF,EAAM0C,OACjC,OAAO0C,GAAIP,EAAKS,MAAQF,EAAIP,EAAKU,OAASF,EAAIR,EAAKW,KAAOH,EAAIR,EAAKY,OAGpE,QAASb,GAAWd,GACnB,MAAOA,GAAK4B,WAAaC,KAAKC,WAAa9B,EAAKT,OAKjD,QAASM,GAAyBV,EAAIjD,GAGrC,IAFA,GACIuD,GADAO,EAAOb,EAEJM,EAAUsC,EAAqB/B,EAAM9D,IAAQ,CACnD,GAAI4E,EAAWrB,GACd,MAAOA,EAEPO,GAAOP,EAGT,MAAO,MAGR,QAASsC,GAAqB5C,EAAIjD,GAGjC,IAAK,GAAWyE,GAFZC,EAAQzB,EAAGmB,WACX0B,EAAc,KACTnB,EAAI,EAAMF,EAAIC,EAAMC,MAAO,CACnC,GAAIG,IACCA,EAAQC,EAAgBN,KAAOK,EAAMzB,SACzCyC,EAAcA,GAAerB,EAC7BqB,EAAcC,EAAqB/F,EAAO8F,EAAarB,IAGzD,MAAOqB,GAGR,QAASC,GAAqB/F,EAAOgG,EAAQC,GAC5C,GAAIC,GAAoBC,EAAsBH,EAAQhG,GAClDoG,EAAmBD,EAAsBF,EAAOjG,EACpD,OAAIoG,IAAoBF,GACvBE,IAAqBF,GACrBE,EAAiBZ,KAAOU,EAAkBV,IACnCS,EAEAD,EAIT,QAASG,GAAsBrC,EAAM9D,GAIpC,IAAK,GAAW6E,GAHZQ,EAAIrF,EAAM0C,QACVoC,EAAQC,EAAgBjB,GACxBuC,EAAc,KACTrB,EAAI,EAASH,EAAOC,EAAME,MAC9BH,EAAKW,IAAMH,IACdgB,EAAcA,GAAexB,EACzBwB,IAAgBxB,GAAQA,EAAKW,KAAOa,EAAYb,MACnDa,EAAcxB,GAIjB,OAAOwB,GA5PR,GAAIxF,GAAmB,eACnBE,EAAiB,aAGjBV,EAAiB,IAIrBpB,GAAOiD,iBACNoE,OAAQ,SAASnH,EAASoH,GACrBA,IACH1F,EAAmB0F,EAAQ1F,kBAAoBA,EAC/CE,EAAiBwF,EAAQxF,gBAAkBA,EAC3C7B,EAAaC,IAEdkB,EAAiB,GAAI6B,iBAAgBC,IAAIqE,gBAE1CC,QAAS,SAAStH,GACjBM,EAAeN,GACfU,KAEDsC,OAKD,IAAInB,GAAc,KACdE,EAAY,KACZd,EAAY,MAmOdsG,MAOH,SAAUzH,GACT,YAEA,SAASuH,KACRE,KAAKC,UAAW,EAGjBH,EAAelC,UAAUhE,aAAe,SAASsG,GAC3CF,KAAKC,UACTjG,OAAOmG,sBAAsB,WAC5BD,IACAF,KAAKC,UAAW,GACfG,KAAKJ,OAERA,KAAKC,UAAW,GAGjB1H,EAAOiD,gBAAgBC,IAAIqE,eAAiBA,GAE1CE,MAMH,SAAUzH,GACT,YAEA,SAASmD,GAAMH,GACd,GAAI8E,GAAQ9E,EAAWI,QAAQ,EAC/BqE,MAAKjE,QAAUsE,EAAMtE,QACrBiE,KAAKhE,QAAUqE,EAAMrE,QACrBgE,KAAKM,MAAQD,EAAMC,MACnBN,KAAKO,MAAQF,EAAME,MAGpBhI,EAAOiD,gBAAgBC,IAAIC,MAAQA,GAEjCsE,MAEF,WAGA,IAAK,GAFDQ,GAAW,EACXC,GAAW,KAAM,MAAO,SAAU,KAC7B/B,EAAI,EAAGA,EAAI+B,EAAQ9D,SAAW3C,OAAOmG,wBAAyBzB,EACtE1E,OAAOmG,sBAAwBnG,OAAOyG,EAAQ/B,GAAK,yBACnD1E,OAAO0G,qBAAuB1G,OAAOyG,EAAQ/B,GAAK,yBACjD1E,OAAOyG,EAAQ/B,GAAK,8BAGjB1E,QAAOmG,wBACXnG,OAAOmG,sBAAwB,SAASQ,GACvC,GAAIC,IAAW,GAAIC,OAAOC,UACtBC,EAAaC,KAAKC,IAAI,EAAG,IAAML,EAAWJ,IAC1CU,EAAKlH,OAAOmH,WAAW,WACzBR,EAASC,EAAWG,IAErBA,EAED,OADAP,GAAWI,EAAWG,EACfG,IAIJlH,OAAO0G,uBACX1G,OAAO0G,qBAAuB,SAASQ,GACtCE,aAAaF"}