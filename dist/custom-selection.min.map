{"version":3,"file":"custom-selection.min.js","sources":["custom-selection.js"],"names":["global","bindTouchFor","element","$","on","e","preventDefault","originalEvent","clearSelection","eventAnchor","getTouchedElementFromEvent","point","getTouchPoint","markStart","lastPoint","requestTick","getTouchedElementByPoint","markEnd","ticking","console","log","startAnchor","endAnchor","startOffset","endOffset","createSelection","window","getSelection","removeAllRanges","startMarkerClass","remove","endMarkerClass","range","document","createRange","setStart","setEnd","addRange","touchEvent","touch","touches","clientX","clientY","pageX","pageY","target","touchPoint","elementFromPoint","startMarker","createMarker","markerOffset","mark","parentNode","endMarker","kind","span","createElement","setAttribute","func","requestAnimationFrame","el","marker","textNode","getFromElNodeContainingPoint","length","trimPosition","subNode","splitText","nodeContainsPoint","putMarkerBefore","getClosestTextNodeFromEl","putMarkerAfter","normalize","getIndexOfElement","node","insertBefore","nextSibling","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","i","nodeIsText","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","CustomSelection","enable","options","disable","this"],"mappings":"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"}