{"version":3,"file":"custom-selection.min.js","sources":["custom-selection.js"],"names":["removeMarkers","$","remove","requestTick","func","ticking","window","requestAnimationFrame","createSelection","range","document","createRange","setStart","startAnchor","startOffset","setEnd","endAnchor","endOffset","getSelection","addRange","mark","el","point","marker","textNode","getFromElNodeContainingPoint","length","trimPosition","subNode","splitText","nodeContainsPoint","putMarkerBefore","getClosestTextNodeFromEl","putMarkerAfter","parentNode","normalize","getIndexOfElement","node","insertBefore","nextSibling","appendChild","createMarker","kind","span","createElement","setAttribute","element","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","i","nodeIsText","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","clientX","y","clientY","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","logg","m","text","initCanvas","canvas","getElementById","width","height","context","getContext","drawNode","r","drawRect","beginPath","lineWidth","strokeStyle","stroke","drawCircle","arc","Math","PI","startMarker","endMarker","lastPoint","on","e","originalEvent","touches","removeAllRanges","touch","pageX","pageY","eventAnchor","target","markerOffset","preventDefault","elementFromPoint","console","log"],"mappings":"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"}