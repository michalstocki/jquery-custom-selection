{"version":3,"file":"custom-selection.min.js","sources":["custom-selection.js"],"names":["global","bindTouchFor","element","$","on","handleTouchStart","handleTouchMove","handleTouchEnd","unbindTouchFor","off","e","originalEvent","clearSelection","eventAnchor","getTouchedElementFromEvent","point","getTouchPoint","markStart","preventDefault","lastPoint","frameRequester","requestFrame","getTouchedElementByPoint","markEnd","console","log","startAnchor","endAnchor","startOffset","endOffset","createSelection","window","getSelection","removeAllRanges","startMarkerClass","remove","endMarkerClass","range","document","createRange","setStart","setEnd","addRange","touchEvent","CustomSelection","Lib","Point","touches","target","touchPoint","elementFromPoint","clientX","clientY","startMarker","createMarker","markerOffset","mark","parentNode","endMarker","kind","span","createElement","setAttribute","el","marker","textNode","getFromElNodeContainingPoint","length","trimPosition","subNode","splitText","nodeContainsPoint","putMarkerBefore","getClosestTextNodeFromEl","putMarkerAfter","normalize","getIndexOfElement","node","insertBefore","nextSibling","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","i","nodeIsText","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","enable","options","FrameRequester","disable","this","_ticking","func","requestAnimationFrame","bind","touch","pageX","pageY"],"mappings":"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"}