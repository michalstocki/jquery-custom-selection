{"version":3,"file":"custom-selection.min.js","sources":["custom-selection.js"],"names":["global","enableTouchSelectionFor","element","$","on","handleGlobalTouchMove","handleGlobalTouchEnd","hammer","handleGlobalTapHold","disableTouchSelectionFor","off","e","gesture","getTouchedElementFromEvent","point","getTouchPoint","clearSelection","wrapWithMarkersWordAtPoint","createSelection","jqueryEvent","isMarker","target","handleMarkerTouchMove","preventDefault","lastPoint","originalEvent","frameRequester","requestFrame","eventAnchor","getTouchedElementByPoint","mark","updateSelection","startMarker","endMarker","window","getSelection","removeAllRanges","detach","parentNode","range","document","createRange","startAnchor","endAnchor","startOffset","getIndexOfElement","endOffset","setStart","setEnd","collapsed","addRange","touchEvent","CustomSelection","Lib","Point","touches","pointers","touchPoint","elementFromPoint","clientX","clientY","createMarker","kind","span","createElement","setAttribute","textNode","getFromElNodeContainingPoint","length","trimPosition","subNode","splitText","nodeContainsPoint","potentialSpace","data","previousSibling","nodeIsText","putMarkerBefore","putMarkerAfter","nextSibling","normalize","el","marker","getClosestTextNodeFromEl","node","insertBefore","appendChild","elements","parentElement","childNodes","Array","prototype","indexOf","call","n","nodes","i","rect","rects","getRectsForNode","j","rectContainsPoint","selectNode","getClientRects","x","y","left","right","top","bottom","nodeType","Node","TEXT_NODE","getClosestNodeFromEl","closestNode","getNodeCloserToPoint","winner","rival","nearestWinnerRect","getRectNearestToPoint","nearestRivalRect","nearestRect","Hammer","defaults","cssProps","userSelect","startMarkerClass","endMarkerClass","enable","options","FrameRequester","disable","this","_ticking","func","requestAnimationFrame","bind","touch","pageX","pageY","lastTime","vendors","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout"],"mappings":"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"}